(function(a){if(a.psd==undefined){a.psd={}}if(a.psd.parallax==undefined){a.psd.parallax={}}a.psd.parallax.debug=false;if(a.location.href.indexOf("debug")!=-1){a.psd.parallax.debug=true}})(window);(function(b){a.prototype=new psd.fenix.DisplayObject();function a(){psd.fenix.DisplayObject.call(this);this.className="psd.parallax.Camera";this.rotationX=0;this.rotationY=0}b.Camera=a})(psd.parallax);(function(b){a.prototype=new psd.framework.EventDispatcher();function a(g,e){psd.framework.EventDispatcher.call(this);this.className="psd.parallax.CameraPath";var i=new TimelineLite({paused:true});var j={x:0,y:0,z:0,rotationX:0,rotationY:0};var f=g;var c=e;var h=function(){f.apply(c,[j.x,j.y,j.z,j.rotationX,j.rotationY])};var d=(function(k){return function(l){h.apply(k,[l])}})(this);this.addPosition=function(k,l,m){i.to(j,l,{x:k.x,y:k.y,z:k.z,rotationX:k.rotationX,rotationY:k.rotationY,ease:m,onUpdate:d})};this.start=function(k){j.x=k.x;j.y=k.y;j.z=k.z;j.rotationX=k.rotationX;j.rotationY=k.rotationY;i.play()};this.play=function(){i.play()};this.pause=function(){i.pause()};this.resume=function(){i.resume()};this.reverse=function(){i.reverse()};this.paused=function(){return i.paused()};this.reversed=function(){return i.reversed()}}b.CameraPath=a})(psd.parallax);(function(a){b.prototype=new psd.fenix.DisplayObjectContainer();function b(){psd.fenix.DisplayObjectContainer.call(this);this.className="psd.parallax.Layer";this.vertical=0.5;this.horizon=0.5;this.scale=1;this.addContent=function(c){this.addChild(c)}}a.Layer=b})(psd.parallax);(function(a){b.prototype=new psd.fenix.DisplayObjectContainer();function b(){psd.fenix.DisplayObjectContainer.call(this);this.className="psd.parallax.Parallax";var c=[];var d=0;var i=new psd.parallax.Camera();var h=function(){var j,k;this.removeAllChildren();k=c.slice();k.sort(function(m,l){return l.depth-m.depth});for(j in k){this.addChild(k[j].layer)}};var g=function(){var n,p,o,t,j,w,m,s,u,k,l,q,r=this.stage();if(r!=null){for(n in c){p=c[n].layer;o=c[n].depth;t=c[n].bounds;if(o<b.BACKGROUND_LAYER){p.removeEventListener(psd.fenix.StageEvent.RESIZE,g,this);p.scaleX(1);p.scaleY(1);w=this.height()/2-p.height()*p.horizon;j=this.width()/2-p.width()/2;widthDiff=(this.width()/2+i.x)-j;l=(this.height()/2+i.y)-w;q=o-i.z+1;var v=((d!=0)&&(q>d))||(q<1);if(v){p.visible=false}else{p.visible=true;p.scaleX(p.scale/q);p.scaleY(p.scale/q);p.x=this.width()/2-Math.sin(i.rotationX)*r.stageWidth()-widthDiff/q-p.width()*p.vertical;u=((this.x+p.x)<0!=t.left);k=((this.x+p.x+p.width())<r.stageWidth()!=t.right);p.y=this.height()/2-Math.sin(i.rotationY)*r.stageHeight()-l/q-p.height()*p.horizon;m=((this.y+p.y)<0!=t.top);s=((this.y+p.y+p.height())>r.stageHeight()!=t.bottom);if(!u){t.left=!t.left}if(!k){t.right=!t.right}if(!m){t.top=!t.top}if(!s){t.bottom=!t.bottom}}p.addEventListener(psd.fenix.StageEvent.RESIZE,g,this)}else{p.x=r.stageWidth()/2-p.width()/2-this.x;p.y=r.stageHeight()/2-this.y-p.height()*p.horizon}}}};var e=function(j){g.apply(this)};this.addEventListener(psd.fenix.StageEvent.ADDED_TO_STAGE,e,this);b.BACKGROUND_LAYER=10000;this.addLayer=function(j,k){if(k<=b.BACKGROUND_LAYER){j.addEventListener(psd.fenix.StageEvent.RESIZE,g,this);c[k]={layer:j,depth:k,bounds:{top:true,bottom:true,left:true,right:true}};h.apply(this);g.apply(this)}};this.setViewingArea=function(j){d=j*2};this.moveCamera=function(j,n,m,l,k){i.x=j;i.y=n;i.z=m;if(l>Math.PI/2){l=Math.PI/2}if(l<-Math.PI/2){l=-Math.PI/2}if(k>Math.PI/2){k=Math.PI/2}if(k<-Math.PI/2){k=-Math.PI/2}i.rotationX=l;i.rotationY=k;g.apply(this)};var f=new psd.parallax.CameraPath(this.moveCamera,this);this.path=function(){return f};this.camera=function(){return{x:i.x,y:i.y,z:i.z,rotationX:i.rotationX,rotationY:i.rotationY}}}a.Parallax=b})(psd.parallax);