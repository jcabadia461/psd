<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">

	<head>
		<title>Tests SimpleMediaPlayer cadenaser - Triton</title>
		<link href="forms.css" rel="stylesheet" type="text/css">
		<script type="text/javascript" src="/psdmedia/media/simple/js/SimpleMediaPlayer.min.js"></script>
		
		<style type="text/css"> 
			
			#button
			{
				float:left;
			}
			
			#media_player_container
			{
				float:left;
				margin-top:30px;
				position:fixed;
				left:10px;
			}
			
			#companion_container
			{
				float:left;
				width: 300px;
				height: 250px;
				background-color:#bebbbb;
				position:fixed;
				margin-top:30px;
				left:400px;
			}
			
			#media_player_console
			{
				float:right;
				width:40%;
				padding: 1%;
			}
			
			#console
			{
				height: 100%;
			}
			
		</style>
	</head>
	
	<body>
		<div>
			<button id="button" type="button" name="onCompanion_btn" value="onCompanion" onclick="onCompanion()" disabled>Load Companion</button>
			<br>
			<div id="media_player_container"></div>		
			<div id="companion_container"></div>			
			<div id="media_player_console">
					<fieldset>
						<legend>Console</legend>
						<textarea id="console" readonly="readonly" rows="20" cols="25"></textarea>
					</fieldset>
			</div>
		</div>
		
		<script type="text/javascript">
			
			window.onload = loadPlayer;
			
			function loadPlayer()
			{
				var settingsForm = document.forms[0],
					playerConfig = { };
				 
				playerConfig.id = "media_player_container";
				
				playerConfig.media = {
							type: "audio/mp4"
							, title: "live streamtheworld"
							, desc: "canal live de streamtheworld"
							//, src: "MAXIMAFMANDOTESTAAC"    
							, src: "MAXIMAFMANDOTEST"    
							, srcHTML5: "http://playerservices.streamtheworld.com/api/livestream-redirect/LOS40_SC"
							, live: true
							, cdn: { provider: "streamtheworld" }
						}
				
				
				playerConfig.ads = {};
				playerConfig.ads.conf = "/psdmedia/media/simple/skins/cadenaser/conf_Publi_STW.xml";
				playerConfig.ads.tags = "SER_RADIO";

				playerConfig.player = {};
				playerConfig.player.container = "media_player_container";
				playerConfig.player.width = "362";
				playerConfig.player.height = "48"; 
				
				playerConfig.skin = {};
				playerConfig.skin.id = "cadenaser";
				playerConfig.skin.volumeControl = "true";
				
				mediaPlayer = new psd.media.SimpleMediaPlayer(playerConfig);
				mediaPlayer.addEventListener(psd.media.MediaEvent.MEDIA_BEGIN, onMediaBegin, mediaPlayer);
				mediaPlayer.addEventListener(psd.media.MediaEvent.MEDIA_COMPLETE, onMediaComplete);
				mediaPlayer.addEventListener(psd.media.MediaEvent.CUEPOINT_DATA, onCuePointData);
				mediaPlayer.addEventListener(psd.media.MediaEvent.INITIALIZED, onMediaPlayerInitialized);
				mediaPlayer.addEventListener(psd.media.MediaEvent.MEDIA_START, onMediaPlayerStart);
				mediaPlayer.addEventListener(psd.media.MediaEvent.MEDIA_STOP, onMediaPlayerStop);
				mediaPlayer.addEventListener(psd.media.MediaEvent.AD_START, onMediaAdStart);
				mediaPlayer.addEventListener(psd.media.MediaEvent.AD_SKIP, onMediaAdSkip);
				mediaPlayer.addEventListener(psd.media.MediaEvent.AD_COMPLETE, onMediaAdStop);
				mediaPlayer.addEventListener(psd.media.MediaEvent.AD_COMPANION_ON, onAdCompanionOn);
				mediaPlayer.addEventListener(psd.media.MediaEvent.AD_COMPANION_OFF, onAdCompanionOff); 
				mediaPlayer.init();
			}
						
			function onMediaComplete()
			{
				document.getElementById("console").value+="onMediaComplete...\n"; 
			}
			
			function onMediaPlayerInitialized()
			{
				document.getElementById("console").value+="onMediaPlayerInitialized...\n"; 
			}
			
			function onMediaBegin(evt)
			{
				document.getElementById("console").value+="onMediaBegin...\n"; 
			}
			
			function onCuePointData(evt)
			{
				document.getElementById("console").value+="onCuePointData...\n"; 
			}
			
			function onMediaPlayerStart()
			{
				document.getElementById("console").value+="onMediaPlayerStart...\n"; 
				
				//Activ button Load Companion
				document.getElementById("button").disabled = false;

			}
			
			function onMediaPlayerStop()
			{
				document.getElementById("console").value+="onMediaPlayerStop...\n"; 
			}
			
			function onMediaAdStart(evt)
			{
				document.getElementById("console").value+="onMediaAdStart... " + "||width: " + evt.data.width + " -- height: " + evt.data.height + "\n"; 
				
				if (evt.data.height != 0)
				{
					document.getElementById("media_player_container").style.height =  evt.data.height + "px";
					document.getElementById("media_player_container_simple").style.height =  evt.data.height + "px";
				}
				
			}
			
			function onMediaAdSkip(evt)
			{
				document.getElementById("console").value+="onMediaAdSkip...\n"; 
				
				document.getElementById("media_player_container").style.height =  "48px";
				document.getElementById("media_player_container_simple").style.height =  "48px";
			}
			
			function onMediaAdStop()
			{
				document.getElementById("console").value+="onMediaAdStop...\n"; 
				
				document.getElementById("media_player_container").style.height =  "48px";
				document.getElementById("media_player_container_simple").style.height =  "48px";
			}
			
			function onAdCompanionOn(evt) 
			{
				//document.getElementById("console").value+="onAdCompanionOn... - companionAd" + evt.data.companionAd + " ||type: " + evt.data.companionType + "\n";  
				document.getElementById("console").value+="onAdCompanionOn...\n";  
				
				var mobile = (/iphone|ipad|ipod|android|blackberry|mini|windows\sce|palm/i.test(navigator.userAgent.toLowerCase()));
				
				for (i=0;i<evt.data.companionAd.ads.length;i++)
				{
					if (evt.data.companionAd.ads[i].companionType == "htmlResource") 
					{
					
						//MÃ³viles (320x50)
						if ((mobile) && (evt.data.companionAd.ads[i].size.height <= 50))
						{
							paintCompanion(evt.data.companionAd.ads[i].companionAd);
						}
						
						//Navegador (300X250)
						else if ((!mobile) &&(evt.data.companionAd.ads[i].size.width == 300) && (evt.data.companionAd.ads[i].size.height == 250))
						{
							paintCompanion(evt.data.companionAd.ads[i].companionAd);
						}
					}
				}
			}
			
			
			function paintCompanion(ad)
			{
				//document.getElementById("companion_container").innerHTML = "<img alt='big_boxOnly' src='http://cmod.live.streamtheworld.com/ondemand/viewtrack?type=cm-spot&amp;cid=Y206YWQ9MTA2ODExJmM9MTAyMSZhPTU2MQ&amp;stid=52079&amp;lsid=12385644&amp;cb=1803959276&amp;redir=http://cmodmedia.live.streamtheworld.com/media/cm-image/cm:561.jpg'/>"; 
				document.getElementById("companion_container").innerHTML = ad; 
			}
			
			function onAdCompanionOff()
			{
				document.getElementById("console").value+="onAdCompanionOff...\n"; 
				
				var companionDiv = document.getElementById("companion_container");
				while (companionDiv.hasChildNodes()) {
					companionDiv.removeChild(companionDiv.firstChild);
				}
			}
			
			function onCompanion()
			{
				mediaPlayer.isPlaying();
			}	
			
		</script>
		
	</body> 
</html>